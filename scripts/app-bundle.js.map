{"version":3,"sources":["../src/app.ts","../style/_colors.scss","../src/app.scss","../src/board/_tile.scss","../src/board/_board.scss","../src/board/_tragedy.scss","../src/player/_player.scss","../src/commands/_index.scss","../src/buildings/_purchase-panel.scss","../src/buildings/_tile-building.scss","../src/app.html","../src/board/board.ts","../src/board/board.html","../src/board/index.ts","../src/board/tile.ts","../src/board/tile.html","../src/board/tragedy.ts","../src/board/tragedy.html","../src/buildings/index.ts","../src/buildings/purchase-panel.ts","../src/buildings/purchase-panel.html","../src/buildings/tile-building.ts","../src/buildings/tile-building.html","../src/commands/command-bar.ts","../src/commands/command-bar.html","../src/commands/dice.ts","../src/commands/dice.html","../src/commands/index.ts","../src/commands/resources-overview.ts","../src/commands/resources-overview.html","../src/commands/save.ts","../src/commands/save.html","../src/commands/tragedy-overview.ts","../src/commands/tragedy-overview.html","../src/environment.ts","../src/main.ts","../src/player/index.ts","../src/player/player.ts","../src/player/player.html","../src/store/actions/commands.ts","../src/store/actions/tragedy-events.ts","../src/store/helper.ts","../src/store/index.ts","../src/store/state.ts","../src/utils/generic-dialog.html","../src/utils/utils.ts"],"names":[],"mappings":"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","file":"app-bundle.js","sourcesContent":["import { DialogService } from \"aurelia-dialog\";\nimport { autoinject } from \"aurelia-framework\";\nimport {\n  localStorageMiddleware,\n  MiddlewarePlacement,\n  rehydrateFromLocalStorage,\n  Store\n} from \"aurelia-store\";\nimport { skip, take } from \"rxjs/operators\";\n\nimport {\n  collapsedMines,\n  defiledAltar,\n  forgottenEquipment,\n  pausedResourceProduction,\n  ragingFire,\n  sacrificeResources,\n  stumblingSteps\n} from \"./store/actions/tragedy-events\";\nimport {\n  buyBuilding,\n  closePurchasePanel,\n  LOCALSTORAGE_SAVE_KEY,\n  openPurchaseForTile,\n  rollDice,\n  State\n} from \"./store/index\";\n\n@autoinject()\nexport class App {\n  public commandBarVisible: boolean = true;\n\n  constructor(\n    private store: Store<State>,\n    private dialogService: DialogService\n  ) {\n    this.store\n      .state\n      .pipe(\n        skip(1),\n        take(1)\n      ).subscribe(() => {\n        this.store.registerMiddleware(\n          localStorageMiddleware,\n          MiddlewarePlacement.After,\n          { key: LOCALSTORAGE_SAVE_KEY }\n        );\n      });\n\n    this.store.registerAction(\"Rehydrate from localstorage\", rehydrateFromLocalStorage);\n    this.store.registerAction(\"roll the dice\", rollDice);\n    this.store.registerAction(\"open the purchase panel\", openPurchaseForTile);\n    this.store.registerAction(\"close the purchase panel\", closePurchasePanel);\n    this.store.registerAction(\"buy a tile building\", buyBuilding);\n    this.store.registerAction(\"[tragedy] sacrifice resources\", sacrificeResources);\n    this.store.registerAction(\"[tragedy] raging fire\", ragingFire);\n    this.store.registerAction(\"[tragedy] the forgotten equipment\", forgottenEquipment);\n    this.store.registerAction(\"[tragedy] a defiled altar\", defiledAltar);\n    this.store.registerAction(\"[tragedy] paused resource production\", pausedResourceProduction);\n    this.store.registerAction(\"[tragey] collapsed mines\", collapsedMines);\n    this.store.registerAction(\"[tragey] stumbling steps\", stumblingSteps);\n\n    this.store.dispatch(rehydrateFromLocalStorage, LOCALSTORAGE_SAVE_KEY);\n  }\n\n  public attached() {\n    window.addEventListener(\"keyup\", this.handleGlobalKeys);\n  }\n\n  public detached() {\n    window.removeEventListener(\"keyup\", this.handleGlobalKeys);\n  }\n\n  private handleGlobalKeys = (event: KeyboardEvent) => {\n    if (!this.dialogService.hasOpenDialog && event.keyCode === 13) {\n      this.store.dispatch(rollDice);\n    }\n  }\n}\n","/* stylelint-disable */\n$graphite: #2A2708;\n$stonewall: #928573;\n$beaver: #896552;\n$gold: #FFD700;\n$iron: #D4D7D9;\n$charcoal: #36454F;\n$blood: #8a0303;\n$eastbay: #3C4777;\n$cod-gray: #0f0f0e;\n$tuatara: #292927;\n\n/* General */\n$body-bg: $tuatara;\n$toggle-cbar-btn-bg: $cod-gray;\n$toggle-cbar-btn-fg: $stonewall;\n$dialog-overlay-bg: $cod-gray;\n\n/* Tiles */\n$tile-bg: $cod-gray;\n$tile-border-bg: black;\n$tile-bg--wood: $graphite;\n$tile-bg--stone: $stonewall;\n$tile-bg--iron: $iron;\n$tile-bg--gold: $gold;\n$tile-bg--food: $beaver;\n$tile-bg--mana: $eastbay;\n$tile-bg--coal: $charcoal;\n$tile-bg--blood: $blood;\n$tile-bg--start: white;\n\n\n/* Fortress */\n$fortress-bg: lightgray;\n\n/* Player */\n$player-bg-border: red;\n\n/* Commands */\n$dice-text-bg: white;\n\n/* Purchase panel */\n$purchase-panel-bg: black;\n\n/* Buildings */\n$building-radial-bg: $tuatara;\n$building-indicator-bg: black;\n/* stylelint-enable */\n","@import \"../style/colors\";\n\n.body {\n  background-color: $body-bg;\n  margin: 0;\n  user-select: none;\n}\n\n.main {\n  display: flex;\n  height: 100vh;\n  margin: 0 auto;\n  width: 100vw;\n\n  &__command-bar {\n    flex-grow: 1;\n  }\n\n  &__board {\n    flex-grow: 22;\n  }\n\n  &__toggle-command-bar {\n    background-color: $toggle-cbar-btn-bg;\n    border: none;\n    color: $toggle-cbar-btn-fg;\n\n    &::-moz-focus-inner { \n      border: 0;\n    }\n    &:focus { outline: none; }\n\n    @media (min-width: 1281px) { \n      display: none;\n    }\n  }\n\n  @media (min-width: 1281px) { \n    height: 50vw;\n    margin: 10px auto;\n    width: 80vw;\n  } \n}\n\n// stylelint-disable-next-line\nux-dialog-overlay.active {\n  background-color: $dialog-overlay-bg;\n  opacity: .5;\n}\n\n@import \"./board/index\";\n@import \"./player/player\";\n@import \"./commands/index\";\n@import \"./buildings/index\";\n",".tile {\n  align-items: center;\n  background-color: $tile-bg;\n  background-repeat: no-repeat;\n  display: flex;\n\tflex-grow: 1;\n  justify-content: center;\n  outline: 1px solid $tile-border-bg;\n  position: relative;\n\n  &--bottom {\n    background-position: bottom center;\n    background-size: 80%;\n  }\n\n  &--top {\n    background-position: top center;\n    background-size: 80%;\n  }\n\n  &--left {\n    background-position: left center;\n  }\n\n  &--right {\n    background-position: right center;\n  }\n\n  &--wood {\n    background-image: url(\"assets/icons/forest.svg\");\n  }\n\n  &--gold {\n    background-image: url(\"assets/icons/two-coins.svg\");\n  }\n\n  &--stone {\n    background-image: url(\"assets/icons/stone-block.svg\");\n  }\n\n  &--iron {\n    background-image: url(\"assets/icons/ore.svg\");\n  }\n\n  &--food {\n    background-image: url(\"assets/icons/wheat.svg\");\n\n  }\n\n  &--mana {\n    background-image: url(\"assets/icons/vortex.svg\");\n  }\n\n  &--coal {\n    background-image: url(\"assets/icons/brick-pile.svg\");\n  }\n\n  &--blood {\n    background-image: url(\"assets/icons/bloody-stash.svg\");\n  }\n\n  &--start {\n    background-image: url(\"assets/icons/direction-signs.svg\");\n  }\n\n  &--tragedy {\n    background-image: url(\"assets/icons/tear-tracks.svg\");\n  }\n\n  &--sacred_grounds {\n    background-image: url(\"assets/icons/tumulus.svg\");\n  }\n\n  &--corner {\n    background-size: initial;\n    flex-direction: column;\n    flex-grow: 2;\n    outline: 1px solid $tile-border-bg;\n    position: relative;\n  }\n\n  &__text {\n    font-size: 14px;\n    font-weight: 500;\n    left: 0;\n    line-height: 1vw;\n    position: absolute;\n    right: 0;\n    text-align: center;\n    top: 12%;\n  }\n\n  &__player {\n    top: 30%;\n  }\n}\n",".board {\n  height: 100%;\n\n  &__row {\n    display: flex;\n    width: 100%;\n    \n    &--top,\n    &--bottom {\n      height: 15.384615385%;\n    }\n\n    &--bottom {\n      flex-flow: row-reverse;\n    }\n\n    &--center {    \n      height: 69.23076923%;\n    }\n  }\n\n  &__col {\n    outline: 1px solid $tile-border-bg;\n    position: relative;\n\n    &--left,\n    &--right {\n      display: flex;\n      flex-direction: column;\n      flex-grow: 2;\n    }\n\n    &--left {\n      flex-flow: column-reverse;\n    }\n\n    &--center {\n      flex-grow: 9;\n    }\n  }\n\n  &__fortress {\n    outline: none;\n  }\n}\n\n.fortress {\n  align-items: center;\n  background-color: $fortress-bg;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  \n\n  &__caption {\n    position: absolute;\n  }\n}\n",".tragedy {\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n\n  &__image {\n    width: 150px;\n  }\n\n  &__description {\n    text-align: justify;\n    text-justify: inter-word;\n    width: 400px;\n  }\n}\n",".player {\n  align-items: center;\n  background-color: $player-bg-border;\n  border: 1px solid $player-bg-border;\n  border-radius: 50%;\n  display: flex;\n  font-size: 10px;\n  height: 4vw;\n  justify-content: center;\n  position: absolute;\n  width: 4vw;\n  z-index: 1;\n}\n",".command {\n  &__icon {\n    height: 40px;\n    width: 40px;\n  }\n}\n\n.command-bar {\n  display: flex;\n  flex-direction: column;\n}\n\n.dice {\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  \n  &__icon {\n    cursor: pointer;\n  }\n\n  &__round {\n    margin: 5px 0;\n  }\n  \n  &__last-roll {\n    background-color: $dice-text-bg;\n    font-size: 20px;\n    margin-top: 5px;\n    text-align: center;\n    width: 50px;\n  }\n}\n\n.resources-overview {\n  &__list {\n    display: flex;\n    flex-direction: column;\n    list-style: none;\n    padding: 0;\n    width: 70px;\n  }\n  \n  &__item {\n    align-items: center;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  &__image {\n    width: 30px;\n  }\n}\n\n.save {\n  &__actions {\n    display: flex;\n    flex-direction: column;\n  }\n}\n\n.tragedy-overview {\n  display: flex;\n  justify-content: center;\n\n  &__image {\n    width: 100px;\n\n    &--hidden {\n      visibility: hidden;\n    }\n  }\n}\n",".purchase-panel {\n  &__list {\n    list-style: none;\n    padding: 0;\n  }\n\n  &__building-icon {\n    width: 70px;\n  }\n\n  &__building-name {\n    display: flex;\n    justify-content: center;\n  }\n\n  &__buy {\n    margin-top: 10px;\n  }\n\n  &__cost {\n    list-style: none;\n    padding: 0 0 0 5px;\n  }\n\n  &__close {\n    margin-bottom: 15px;\n  }\n\n  &__header {\n    margin: 0;\n  }\n}\n\n.cost {\n  &__item {\n    align-items: center;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  &__icon {\n    width: 30px;\n  }\n}\n",".tile-building {\n  display: flex;\n  height: 100%;\n  width: 100%;\n\n  &--bottom {\n    justify-content: center;\n  }\n\n  &--top {\n    align-items: flex-end;\n    justify-content: center;\n  }\n\n  &--left {\n    align-items: center;\n    justify-content: flex-end;\n  }\n\n  &--right {\n    align-items: center;\n    justify-content: flex-start;\n  }\n\n  &__display {\n    background-repeat: no-repeat;\n    \n    &--sawmill {\n      background-image: url(\"assets/icons/crosscut-saw.svg\");\n    }\n\n    &--iron_mine {\n      background-image: url(\"assets/icons/mining.svg\");\n    }\n\n    &--farm {\n      background-image: url(\"assets/icons/windmill.svg\");\n    }\n\n    &--quarry {\n      background-image: url(\"assets/icons/stone-crafting.svg\");\n    }\n\n    &--gold_mine {\n      background-image: url(\"assets/icons/gold-mine.svg\");\n    }\n\n    &--mana_rift {\n      background-image: url(\"assets/icons/magic-portal.svg\");\n    }\n\n    &--coal_mine {\n      background-image: url(\"assets/icons/coal-wagon.svg\");\n    }\n\n    &--butchery {\n      background-image: url(\"assets/icons/meat-cleaver.svg\");\n    }\n\n    &--shrine {\n      background-image: url(\"assets/icons/fire-shrine.svg\");\n    }\n\n    &--bottom {\n      margin-top: 10%;\n      width: 45%;\n    }\n\n    &--top {\n      height: 30%;\n      margin-bottom: 10%;\n      width: 45%;\n    }\n\n    &--left {\n      height: 60%;\n      margin-right: 5%;\n      width: 27%;\n    }\n\n    &--right {\n      height: 60%;\n      margin-left: 5%;\n      width: 27%;\n    }\n  }\n}\n","<template>\n  <require from=\"./app.css\"></require>\n  <div class=\"main\">\n    <button class=\"main__toggle-command-bar\"\n            click.trigger=\"commandBarVisible = !commandBarVisible\">${!commandBarVisible ? \"⇶\" : \"⬱\"}</button>\n    <command-bar class=\"main__command-bar\"\n                 show.bind=\"commandBarVisible\"></command-bar>\n    <board class=\"main__board\"></board>\n  </div>\n</template>\n","import { autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\nimport { Subscription } from \"rxjs\";\n\nimport { State } from \"../store/index\";\nimport { TilePlacement, TileRing } from \"./tile\";\n\n@autoinject()\nexport class Board {\n  public state: State;\n  private subscription: Subscription;\n\n  constructor(private store: Store<State>) {\n    this.subscription = this.store.state.subscribe((state) => this.state = state);\n  }\n\n  public getTiles(ring: TileRing, placement: TilePlacement) {\n    return this.state?.tiles?.filter((t) => t.placement === placement && t.ring === ring);\n  }\n\n  public detached() {\n    this.subscription.unsubscribe();\n  }\n}\n","<template class=\"board\">\n  <div class=\"board__row board__row--top\">\n    <tile repeat.for=\"tile of getTiles('outer', 'top')\"\n          class=\"tile--top\"\n          type.bind=\"tile.type\"\n          is-corner.bind=\"tile.isCorner\"\n          ring.bind=\"tile.ring\"\n          id.bind=\"tile.id\"\n          placement.bind=\"tile.placement\"\n          players.bind=\"state.players\"\n          resources.bind=\"state.resources\"\n          tile-buildings.bind=\"state.tileBuildings\"></tile>\n  </div>\n  <div class=\"board__row board__row--center\">\n    <div class=\"${bem('board', 'col', 'left')}\">\n      <tile repeat.for=\"tile of getTiles('outer', 'left')\"\n            class=\"tile--left\"\n            type.bind=\"tile.type\"\n            is-corner.bind=\"tile.isCorner\"\n            ring.bind=\"tile.ring\"\n            id.bind=\"tile.id\"\n            placement.bind=\"tile.placement\"\n            players.bind=\"state.players\"\n            resources.bind=\"state.resources\"\n            tile-buildings.bind=\"state.tileBuildings\"></tile>\n    </div>\n    <div class=\"${bem('board', 'col', 'center')}\">\n\n      <!-- Inner circle -->\n      <div class=\"board__row board__row--top\">\n        <tile repeat.for=\"tile of getTiles('inner', 'top')\"\n              class=\"tile--top\"\n              type.bind=\"tile.type\"\n              is-corner.bind=\"tile.isCorner\"\n              ring.bind=\"tile.ring\"\n              id.bind=\"tile.id\"\n              placement.bind=\"tile.placement\"\n              players.bind=\"state.players\"\n              resources.bind=\"state.resources\"\n              tile-buildings.bind=\"state.tileBuildings\"></tile>\n      </div>\n      <div class=\"board__row board__row--center\">\n        <div class=\"${bem('board', 'col', 'left')}\">\n          <tile repeat.for=\"tile of getTiles('inner', 'left')\"\n                class=\"tile--left\"\n                type.bind=\"tile.type\"\n                is-corner.bind=\"tile.isCorner\"\n                ring.bind=\"tile.ring\"\n                id.bind=\"tile.id\"\n                placement.bind=\"tile.placement\"\n                players.bind=\"state.players\"\n                resources.bind=\"state.resources\"\n                tile-buildings.bind=\"state.tileBuildings\"></tile>\n        </div>\n        <div class=\"${bem('board', 'col', 'center')}\">\n\n          <!-- Fortress -->\n          <div class=\"board__fortress fortress\">\n            <span class=\"fortress__caption\">Fortress</span>\n          </div>\n          <!-- /Fortress -->\n\n        </div>\n        <div class=\"${bem('board', 'col', 'right')}\">\n          <tile repeat.for=\"tile of getTiles('inner', 'right')\"\n                class=\"tile--right\"\n                type.bind=\"tile.type\"\n                is-corner.bind=\"tile.isCorner\"\n                ring.bind=\"tile.ring\"\n                id.bind=\"tile.id\"\n                placement.bind=\"tile.placement\"\n                players.bind=\"state.players\"\n                resources.bind=\"state.resources\"\n                tile-buildings.bind=\"state.tileBuildings\"></tile>\n        </div>\n      </div>\n      <div class=\"board__row board__row--bottom\">\n        <tile repeat.for=\"tile of getTiles('inner', 'bottom')\"\n              class=\"tile--bottom\"\n              type.bind=\"tile.type\"\n              is-corner.bind=\"tile.isCorner\"\n              ring.bind=\"tile.ring\"\n              id.bind=\"tile.id\"\n              placement.bind=\"tile.placement\"\n              players.bind=\"state.players\"\n              resources.bind=\"state.resources\"\n              tile-buildings.bind=\"state.tileBuildings\"></tile>\n      </div>\n      <!-- /Inner circle -->\n\n    </div>\n    <div class=\"${bem('board', 'col', 'right')}\">\n      <tile repeat.for=\"tile of getTiles('outer', 'right')\"\n            class=\"tile--right\"\n            type.bind=\"tile.type\"\n            is-corner.bind=\"tile.isCorner\"\n            ring.bind=\"tile.ring\"\n            id.bind=\"tile.id\"\n            placement.bind=\"tile.placement\"\n            players.bind=\"state.players\"\n            resources.bind=\"state.resources\"\n            tile-buildings.bind=\"state.tileBuildings\"></tile>\n    </div>\n  </div>\n  <div class=\"board__row board__row--bottom\">\n    <tile repeat.for=\"tile of getTiles('outer', 'bottom')\"\n          class=\"tile--bottom\"\n          type.bind=\"tile.type\"\n          is-corner.bind=\"tile.isCorner\"\n          ring.bind=\"tile.ring\"\n          id.bind=\"tile.id\"\n          placement.bind=\"tile.placement\"\n          players.bind=\"state.players\"\n          resources.bind=\"state.resources\"\n          tile-buildings.bind=\"state.tileBuildings\"></tile>\n  </div>\n</template>\n","import { FrameworkConfiguration } from \"aurelia-framework\";\nimport { Board } from \"./board\";\nimport { Tile } from \"./tile\";\nimport { Tragedy } from \"./tragedy\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    Tile,\n    Board,\n    Tragedy\n  ]);\n}\n","import { autoinject, bindable, computedFrom } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\n\nimport { PurchasePanel } from \"../buildings/purchase-panel\";\nimport { TileBuilding } from \"../buildings/tile-building\";\nimport { Player } from \"../player/player\";\nimport { openPurchaseForTile, Resources, State } from \"../store/index\";\nimport { openDialog } from \"../utils/utils\";\nimport { Tragedy } from \"./tragedy\";\n\nexport type TileType = \"wood\"\n  | \"stone\"\n  | \"food\"\n  | \"gold\"\n  | \"iron\"\n  | \"coal\"\n  | \"mana\"\n  | \"blood\"\n  | \"start\"\n  | \"sacred_grounds\"\n  | \"tragedy\";\n\nexport type TilePlacement = \"bottom\" | \"left\" | \"top\" | \"right\";\nexport type TileRing = \"inner\" | \"outer\";\n\n@autoinject()\nexport class Tile {\n  @bindable public type: TileType;\n  @bindable public placement: TilePlacement;\n  @bindable public isCorner: boolean = false;\n  @bindable public ring: \"inner\" | \"outer\";\n  @bindable public players?: Player[] = [];\n  @bindable public tileBuildings?: TileBuilding[] = [];\n  @bindable public id: string;\n  @bindable public resources: Resources;\n\n  constructor(private store: Store<State>) {\n\n  }\n\n  public async playersChanged() {\n    if (this.type === \"tragedy\" && this.isPlayerOnTile) {\n      await openDialog(Tragedy, {\n        view: \"board/tragedy.html\"\n      }, true);\n    }\n  }\n\n  @computedFrom(\"players\")\n  public get isPlayerOnTile() {\n    return this.players?.filter((p) => p.currentTileId === this.id).length > 0;\n  }\n\n  @computedFrom(\"tileBuildings\")\n  public get isBuildingOnTile() {\n    return this.tileBuildings?.filter((b) => b.tileId === this.id).length > 0;\n  }\n\n  public get tileBuilding() {\n    return this.tileBuildings?.find((b) => b.tileId === this.id);\n  }\n\n  public async openPurchasePanel() {\n    if (this.type !== \"start\" && this.type !== \"tragedy\" && this.isPlayerOnTile) {\n      await this.store.dispatch(openPurchaseForTile, this);\n\n      openDialog(PurchasePanel, {\n        resources: this.resources,\n        tile: this,\n        tileBuilding: this.tileBuildings?.find((b) => b.tileId === this.id),\n        view: \"buildings/purchase-panel.html\",\n      });\n    }\n  }\n}\n","<template title.bind=\"type\"\n          dblclick.delegate=\"openPurchasePanel()\"\n          class=\"${bem('tile', '', [type, isCorner && 'corner'])}\">\n  <player repeat.for=\"player of players\"\n          if.bind=\"isPlayerOnTile\"\n          class=\"tile__player\"\n          name.bind=\"player.name\"\n          current-tile-id.bind=\"$parent.id\"></player>\n\n  <tile-building if.bind=\"isBuildingOnTile\"\n                 tile-id.bind=\"id\"\n                 type.bind=\"tileBuilding.type\"\n                 placement.bind=\"placement\"></tile-building>\n</template>\n","import { DialogController } from \"aurelia-dialog\";\nimport { autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\nimport { take } from \"rxjs/operators\";\n\nimport { AvailableTileBuildings } from \"../buildings/tile-building\";\nimport {\n  collapsedMines,\n  defiledAltar,\n  forgottenEquipment,\n  pausedResourceProduction,\n  ragingFire,\n  sacrificeResources,\n  stumblingSteps\n} from \"../store/actions/tragedy-events\";\nimport { randBetween } from \"../store/helper\";\nimport { State } from \"../store/state\";\nimport { DialogModel } from \"../utils/utils\";\n\n@autoinject()\nexport class Tragedy {\n  public dialogView?: string;\n  public bemclasses?: string;\n  public event?: TragedyEvent;\n  public state: State;\n\n  constructor(\n    public store: Store<State>,\n    public controller: DialogController\n  ) { }\n\n  public activate(model: DialogModel) {\n    this.dialogView = model.view;\n    this.bemclasses = model.bem;\n\n    // only subscribe for one state so we don't run into rerender cycles\n    this.store.state.pipe(take(1)).subscribe((state) => {\n      this.state = state;\n\n      if (this.state.activeTragedy !== undefined) {\n        this.event = {\n          effect: () => `You beared more tragedy than a poor soul can handle`,\n          event: -1,\n          image: \"prayer\",\n          name: \"No more tragedy\",\n          weight: 0,\n        } as TragedyEvent;\n      } else {\n        this.drawRandomTragedyEvent();\n      }\n    });\n  }\n\n  private drawRandomTragedyEvent() {\n    let sum = 0;\n    const r = Math.random();\n    const probability: { [key: number]: number } = tragedyEvents.reduce((acc, curr, idx) => {\n      acc[idx] = curr.weight;\n\n      return acc;\n    }, {});\n\n    for (const i in probability) {\n      if (probability.hasOwnProperty(i)) {\n        sum += probability[i];\n        if (r <= sum) {\n          this.event = tragedyEvents[parseInt(i.toString(), 10)];\n          break;\n        }\n      }\n    }\n  }\n}\n\nexport enum AvailableTragedyEvents {\n  Sacrifice,\n  RagingFire,\n  StumblingSteps,\n  ForgottenEquipment,\n  DefiledAltar,\n  CollapsedMines,\n  Vermins,\n  Rockfall,\n  ShatteringEarth,\n  BurningTrees,\n  ContaminatedBlood\n}\n\nexport interface TragedyEvent {\n  /**\n   * defines the probability this event gets picked\n   * Must be lower 1. Sum of all weights must be 1\n   */\n  weight: number;\n  name: string;\n  image: string;\n  event: AvailableTragedyEvents;\n  /**\n   * performs the events effects and returns the description\n   */\n  effect: (store: Store<State>, state: State) => string;\n}\n\nexport const tragedyEvents: TragedyEvent[] = [\n  {\n    effect: (store, state) => {\n      const amount = randBetween(1, 4);\n      const availableResources = Object.keys(state.resources)\n        .filter((r) => state.resources[r] > 0);\n      const resourceType = availableResources[randBetween(0, availableResources.length - 1)];\n      const description = `In order to please the gods you sacrifice ${amount} of your ${resourceType}.`;\n\n      store.dispatch(sacrificeResources, resourceType, amount);\n\n      return description;\n    },\n    event: AvailableTragedyEvents.Sacrifice,\n    image: \"sacrificial-dagger\",\n    name: \"A sacrifice for the gods\",\n    weight: 0.08\n  },\n  {\n    effect: (store, state) => {\n      if (state.tileBuildings.length === 0) {\n        return \"A building burned to the ground, but luckily it was none of yours.\";\n      }\n\n      const targetBuilding = state.tileBuildings[randBetween(0, state.tileBuildings.length - 1)];\n      const description = `A fire broke out! Your ${targetBuilding.type} burned to the ground.`;\n\n      store.dispatch(ragingFire, targetBuilding.tileId);\n\n      return description;\n    },\n    event: AvailableTragedyEvents.RagingFire,\n    image: \"small-fire\",\n    name: \"Raging fire\",\n    weight: 0.07\n  },\n  {\n    effect: (store) => {\n      store.dispatch(stumblingSteps);\n\n      return \"Your last nights tavern demands it's toll. Your next dice rolls are wonky small steps.\";\n    },\n    event: AvailableTragedyEvents.StumblingSteps,\n    image: \"beer-stein\",\n    name: \"Stumbling steps\",\n    weight: 0.12\n  },\n  {\n    effect: (store) => {\n      store.dispatch(forgottenEquipment);\n\n      return \"You were in such a hurry rushing for the adventure leaving your essentials at the door steps. Go back to the start of your journey and get them.\";\n    },\n    event: AvailableTragedyEvents.ForgottenEquipment,\n    image: \"bindle\",\n    name: \"The forgotten equipment\",\n    weight: 0.11\n  },\n  {\n    effect: (store, state) => {\n      const shrines = state.tileBuildings.filter((tb) => tb.type === \"shrine\");\n      if (shrines.length === 0) {\n        return \"A shrine has been defiled, yet it was one for the wrong gods.\";\n      }\n\n      store.dispatch(defiledAltar);\n\n      return \"Strangers have been seen, defiling one of your shrines. 'Tis your duty to rebuild them in full glory.\";\n    },\n    event: AvailableTragedyEvents.DefiledAltar,\n    image: \"broken-tablet\",\n    name: \"Defiled altar\",\n    weight: 0.07\n  },\n  {\n    effect: (store) => {\n      const mineTypes: AvailableTileBuildings[] = [\n        \"gold_mine\", \"iron_mine\", \"coal_mine\"\n      ];\n\n      const mineType = mineTypes[randBetween(0, mineTypes.length)];\n      const description = `Men screamed and shouted, sealed in the dark groves of your ${mineType}. Poor devils souls, for their life found it's end in the dark.`;\n\n      store.dispatch(collapsedMines, mineType);\n\n      return description;\n    },\n    event: AvailableTragedyEvents.CollapsedMines,\n    image: \"oppression\",\n    name: \"Collapsed mines\",\n    weight: 0.10\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.Vermins);\n\n      return `Your mills got pested by pesky vermins. Until the mess is cleaned no food may be produced.`;\n    },\n    event: AvailableTragedyEvents.Vermins,\n    image: \"rat\",\n    name: \"Plague of vermins\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.Rockfall);\n\n      return `Those giant boulders set loose and burried few of your men. It will take a while until the next shipment is ready.`;\n    },\n    event: AvailableTragedyEvents.Rockfall,\n    image: \"falling-rocks\",\n    name: \"The rockfall\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.ShatteringEarth);\n\n      return `A mighty earth quake shattered your mana rifts. It is nature that shows it's endless power. It will take a wihle until further veils can be casted.`;\n    },\n    event: AvailableTragedyEvents.ShatteringEarth,\n    image: \"earth-spit\",\n    name: \"Shattering earth\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.BurningTrees);\n\n      return `A morron with a torch, none of wisdom on his porch, set ablaze your woods. No more lumber is going soon to find the routes.`;\n    },\n    event: AvailableTragedyEvents.BurningTrees,\n    image: \"burning-tree\",\n    name: \"Burning trees\",\n    weight: 0.09\n  },\n  {\n    effect: (store) => {\n      store.dispatch(pausedResourceProduction, AvailableTragedyEvents.ContaminatedBlood);\n\n      return `One of the corpses was filled with evil gazes. It will take a while to harvest another crop.`;\n    },\n    event: AvailableTragedyEvents.ContaminatedBlood,\n    image: \"infested-mass\",\n    name: \"Contaminated blood\",\n    weight: 0.09\n  }\n];\n","<template class=\"tragedy\">\n  <h4 class=\"tragedy__header\">${event.name}</h4>\n  <img src=\"assets/icons/${event.image}.svg\"\n       class=\"tragedy__image\">\n  <p class=\"tragedy__description\">${event.effect(store, state)}</p>\n  <button class=\"tragedy__button\"\n          data-aid=\"btn-tragedy-accept\"\n          click.trigger=\"controller.ok()\">${event.event === -1 ? \"Praise the gods and continue your journey\" : \"Accept\n    the fate\"}</button>\n</template>\n","import { FrameworkConfiguration } from \"aurelia-framework\";\nimport { PurchasePanel } from \"./purchase-panel\";\nimport { TileBuilding } from \"./tile-building\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    PurchasePanel,\n    TileBuilding\n  ]);\n}\n","import { DialogController } from \"aurelia-dialog\";\nimport { autoinject, bindable, computedFrom } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\n\nimport { Tile } from \"../board/tile\";\n\nimport {\n  buyBuilding,\n  closePurchasePanel,\n  Resources,\n  ResourcesIcons,\n  State\n} from \"../store/index\";\nimport { DialogModel } from \"../utils/utils\";\nimport {\n  TileBuilding,\n  TileBuildingResourceCost,\n  TileBuildingsIcon,\n  TileBuildingsMap\n} from \"./tile-building\";\n\n@autoinject()\nexport class PurchasePanel {\n  @bindable() public tile: Tile;\n  @bindable() public tileBuilding?: TileBuilding;\n  @bindable() public resources: Resources;\n  public dialogView?: string;\n  public bemclasses?: string;\n\n  constructor(\n    private store: Store<State>,\n    public controller: DialogController\n  ) { }\n\n  public activate(model: PurchasePanel & DialogModel) {\n    this.tile = model.tile;\n    this.tileBuilding = model.tileBuilding;\n    this.resources = model.resources;\n    this.dialogView = model.view;\n    this.bemclasses = model.bem;\n  }\n\n  @computedFrom(\"tile\")\n  public get building() {\n    return TileBuildingsMap[this.tile.type];\n  }\n\n  @computedFrom(\"tile\")\n  public get costs() {\n    const entries = Object.entries<number>(TileBuildingResourceCost[this.building]).filter((r) => r[1] !== 0);\n\n    return entries.map((e) => ({\n      icon: ResourcesIcons[e[0]],\n      resource: e[0],\n      value: e[1],\n    }));\n  }\n\n  @computedFrom(\"resources\")\n  public get sufficientResources() {\n    return !this.costs.some((c) => this.resources[c.resource] - c.value < 0);\n  }\n\n  @computedFrom(\"tileBuilding\")\n  public get buildingIcon() {\n    return TileBuildingsIcon[this.building];\n  }\n\n  public buyBuilding() {\n    const newBuilding = {} as TileBuilding;\n    newBuilding.tileId = this.tile.id;\n    newBuilding.type = TileBuildingsMap[this.tile.type];\n    newBuilding.placement = this.tile.placement;\n\n    this.store.dispatch(buyBuilding, newBuilding);\n    this.controller.ok();\n  }\n\n  public closePanel() {\n    this.store.dispatch(closePurchasePanel);\n    this.controller.cancel();\n  }\n}\n","<template class=\"purchase-panel\">\n  <h4 class=\"purchase-panel__header\">Building</h4>\n\n  <ul class=\"purchase-panel__list\">\n    <li class=\"purchase-panel__item\">\n      <span class=\"purchase-panel__building-name\">\n        <img title.bind=\"building\"\n             class=\"purchase-panel__building-icon\"\n             src=\"assets/icons/${buildingIcon}.svg\" />\n      </span>\n      <ul class=\"purchase-panel__cost cost\">\n        <li repeat.for=\"cost of costs\"\n            class=\"cost__item\">\n          <img src=\"assets/icons/${cost.icon}.svg\"\n               title=\"cost.resource\"\n               class=\"cost__icon\" />\n          <span class=\"cost__value\">${cost.value}</span>\n        </li>\n      </ul>\n      <button class=\"purchase-panel__buy\"\n              click.trigger=\"buyBuilding()\"\n              data-aid=\"btn-buy\"\n              disabled.bind=\"tileBuilding || !sufficientResources\"\n              title.bind=\"!sufficientResources ? 'Not enough resources' : 'Buy'\">Buy</button>\n    </li>\n  </ul>\n\n  <button class=\"purchase-panel__close\"\n          click.trigger=\"closePanel()\">Close</button>\n</template>\n","import { bindable } from \"aurelia-framework\";\nimport { TilePlacement, TileType } from \"../board/tile\";\nimport { Resources } from \"../store/state\";\n\nexport type AvailableTileBuildings = \"sawmill\"\n  | \"quarry\"\n  | \"farm\"\n  | \"gold_mine\"\n  | \"iron_mine\"\n  | \"mana_rift\"\n  | \"butchery\"\n  | \"coal_mine\"\n  | \"shrine\";\n\nexport enum TileBuildingsIcon {\n  butchery = \"meat-cleaver\",\n  coal_mine = \"coal-wagon\",\n  farm = \"windmill\",\n  gold_mine = \"gold-mine\",\n  iron_mine = \"mining\",\n  mana_rift = \"magic-portal\",\n  quarry = \"stone-crafting\",\n  sawmill = \"crosscut-saw\",\n  shrine = \"fire-shrine\"\n}\n\nexport const TileBuildingResourceCost: {\n  [key in AvailableTileBuildings]: Resources;\n} = {\n  butchery: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  coal_mine: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  farm: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 6,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 6\n  },\n  gold_mine: {\n    blood: 0,\n    coal: 0,\n    food: 7,\n    gold: 0,\n    iron: 0,\n    mana: 0,\n    stone: 5,\n    wood: 12\n  },\n  iron_mine: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  mana_rift: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 10,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 10\n  },\n  quarry: {\n    blood: 0,\n    coal: 0,\n    food: 5,\n    gold: 8,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 9\n  },\n  sawmill: {\n    blood: 0,\n    coal: 0,\n    food: 0,\n    gold: 5,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 4\n  },\n  shrine: {\n    blood: 0,\n    coal: 0,\n    food: 10,\n    gold: 15,\n    iron: 0,\n    mana: 0,\n    stone: 10,\n    wood: 10\n  }\n};\n\nexport const TileBuildingsMap: {\n  [key in Exclude<TileType, \"start\" | \"tragedy\">]: AvailableTileBuildings\n} = {\n  blood: \"butchery\",\n  coal: \"coal_mine\",\n  food: \"farm\",\n  gold: \"gold_mine\",\n  iron: \"iron_mine\",\n  mana: \"mana_rift\",\n  sacred_grounds: \"shrine\",\n  stone: \"quarry\",\n  wood: \"sawmill\",\n};\n\nexport class TileBuilding {\n  @bindable public tileId: string;\n  @bindable public type: AvailableTileBuildings;\n  @bindable public placement: TilePlacement;\n}\n","<template class=\"${bem('tile-building', '', [placement])}\">\n  <div class=\"${bem('tile-building', 'display', [type, placement])}\"></div>\n</template>\n","export class CommandBar {\n}\n","<template class=\"command-bar\">\n  <dice></dice>\n  <resources-overview></resources-overview>\n  <tragedy-overview></tragedy-overview>\n  <save></save>\n</template>\n","import { autoinject } from \"aurelia-framework\";\nimport { connectTo, Store } from \"aurelia-store\";\nimport { map } from \"rxjs/operators\";\n\nimport { rollDice, State } from \"../store/index\";\n\n@autoinject()\n@connectTo((state: Store<State>) => state.state.pipe(\n  map((value) => ({ lastDiceRoll: value.lastDiceRoll, round: value.round }))\n))\nexport class Dice {\n\n  constructor(private store: Store<State>) {\n\n  }\n\n  public rollDice() {\n    this.store.dispatch(rollDice);\n  }\n}\n","<template class=\"command dice\"\n          title=\"Roll the dice\">\n  <h2 class=\"dice__round\" data-aid=\"current-round\">Round ${state.round}</h2>\n  <img src=\"assets/icons/dice.svg\"\n       click.trigger=\"rollDice()\"\n       class=\"command__icon dice__icon\"\n       data-aid=\"btn-dice-roll\" />\n\n  <span class=\"dice__last-roll\">${state.lastDiceRoll || 'none'}</span>\n</template>\n","import { FrameworkConfiguration } from \"aurelia-framework\";\n\nimport { CommandBar } from \"./command-bar\";\nimport { Dice } from \"./dice\";\nimport { ResourcesOverview } from \"./resources-overview\";\nimport { Save } from \"./save\";\nimport { TragedyOverview } from \"./tragedy-overview\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    CommandBar,\n    Dice,\n    ResourcesOverview,\n    Save,\n    TragedyOverview\n  ]);\n}\n","import { computedFrom } from \"aurelia-framework\";\nimport { connectTo } from \"aurelia-store\";\nimport { upperFirst } from \"lodash\";\nimport { pluck } from \"rxjs/operators\";\n\nimport { Resources, ResourcesIcons } from \"../store/state\";\n\n@connectTo((store) => store.state.pipe(pluck(\"resources\")))\nexport class ResourcesOverview {\n  public state: Resources;\n\n  @computedFrom(\"state\")\n  public get resources() {\n    if (!this.state) {\n      return [];\n    }\n\n    return Object.entries(this.state)\n      .map((e) => ({\n        icon: ResourcesIcons[e[0]],\n        name: upperFirst(e[0]),\n        value: e[1],\n      }));\n  }\n}\n","<template class=\"resources-overview\">\n  <ul class=\"resources-overview__list\">\n    <li class=\"resources-overview__item\"\n        repeat.for=\"res of resources\">\n      <img title.bind=\"res.name\"\n           class=\"resources-overview__image\"\n           src=\"assets/icons/${res.icon}.svg\" />\n      <span class=\"resources-overview__value\">${res.value}</span>\n    </li>\n  </ul>\n</template>\n","import { autoinject } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\n\nimport { initialState, LOCALSTORAGE_SAVE_KEY, State } from \"../store/state\";\n\n@autoinject()\nexport class Save {\n\n  constructor(private store: Store<State>) { }\n\n  public newGame() {\n    this.store.resetToState(initialState);\n    window.localStorage.removeItem(LOCALSTORAGE_SAVE_KEY);\n    window.location.reload();\n  }\n\n  public saveGame() {\n    const data = new Blob([window.localStorage.getItem(LOCALSTORAGE_SAVE_KEY) || \"{}\"], { type: \"application/json\" });\n    const url = window.URL.createObjectURL(data);\n    const anchor = document.createElement(\"a\");\n    anchor.href = url;\n    anchor.target = \"_blank\";\n    anchor.download = \"enforted-save.json\";\n    anchor.click();\n\n    window.URL.revokeObjectURL(url);\n  }\n}\n","<template class=\"save\">\n  <div class=\"save__actions\">\n    <button class=\"save__to-file\"\n            click.trigger=\"saveGame()\">Save game</button>\n    <button class=\"save__new-game\"\n            click.trigger=\"newGame()\">New game</button>\n  </div>\n</template>\n","import { computedFrom } from \"aurelia-framework\";\nimport { connectTo } from \"aurelia-store\";\nimport { pluck } from \"rxjs/operators\";\n\nimport { AvailableTragedyEvents, tragedyEvents } from \"../board/tragedy\";\n\n@connectTo((store) => store.state.pipe(pluck(\"activeTragedy\")))\nexport class TragedyOverview {\n  public state: AvailableTragedyEvents;\n\n  @computedFrom(\"state\")\n  public get tragedy() {\n    return tragedyEvents.find((te) => te.event === this.state);\n  }\n}\n","<template class=\"tragedy-overview\">\n  <img src=\"assets/icons/${tragedy.image}.svg\"\n       title.bind=\"tragedy.name\"\n       class=\"${bem('tragedy-overview', 'image', !tragedy && 'hidden')}\">\n</template>\n","export default {\n  debug: true,\n  testing: true\n};\n","import { Aurelia } from \"aurelia-framework\";\nimport environment from \"./environment\";\n\nimport { initialState } from \"./store/index\";\n\nexport function configure(aurelia: Aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .plugin(\"aurelia-bem\")\n    .plugin(\"aurelia-store\", {\n      initialState\n    })\n    .plugin(\"aurelia-dialog\")\n    .feature(\"board\")\n    .feature(\"player\")\n    .feature(\"commands\")\n    .feature(\"buildings\");\n\n  aurelia.use.developmentLogging(environment.debug ? \"debug\" : \"warn\");\n\n  if (environment.testing) {\n    aurelia.use.plugin(\"aurelia-testing\");\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import { FrameworkConfiguration } from \"aurelia-framework\";\n\nimport { Player } from \"./player\";\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    Player\n  ]);\n}\n","import { autoinject, bindable } from \"aurelia-framework\";\nimport { Store } from \"aurelia-store\";\n\nimport { Tile } from \"../board/tile\";\nimport { State } from \"../store/state\";\n\n@autoinject()\nexport class Player {\n  @bindable public currentTileId: string;\n  @bindable public name: string;\n\n  private currentTile: Tile = {} as Tile;\n\n  constructor(private store: Store<State>) { }\n\n  public currentTileIdChanged() {\n    this.currentTile = (this.store as any)._state.getValue();\n  }\n}\n","<template class=\"player\" data-aid=\"player\">\n  ${name}\n</template>\n","import { Tile } from \"../../board/tile\";\nimport { AvailableTragedyEvents } from \"../../board/tragedy\";\nimport { AvailableTileBuildings, TileBuilding, TileBuildingResourceCost } from \"../../buildings/tile-building\";\nimport { Player } from \"../../player/player\";\nimport { randBetween } from \"../helper\";\nimport { State } from \"../index\";\nimport { Resources } from \"../state\";\n\nexport function rollDice(state: State, diceOverload?: number): State {\n  const isStumblingStep = state.activeTragedy === AvailableTragedyEvents.StumblingSteps;\n  const idxOfTile = state.tiles.findIndex((t) => t.id === state.players[0].currentTileId);\n  const roll = diceOverload || (isStumblingStep ? 1 : randBetween(1, 6));\n  const newPosition = idxOfTile + roll;\n  const isNextRound = newPosition > state.tiles.length - 1;\n  const newStumblingSteps = (state.activeTragedyParams === undefined || state.activeTragedyParams[0] === 1)\n    ? undefined\n    : [state.activeTragedyParams[0] - 1];\n\n  return {\n    ...state,\n    activeTragedy: isNextRound\n      ? undefined\n      : isStumblingStep && newStumblingSteps === undefined\n        ? undefined\n        : state.activeTragedy,\n    activeTragedyParams: isNextRound\n      ? undefined\n      : isStumblingStep\n        ? newStumblingSteps\n        : state.activeTragedyParams,\n    lastDiceRoll: roll,\n    players: [\n      {\n        ...state.players[0],\n        currentTileId: newPosition > state.tiles.length - 1\n          ? state.tiles[Math.abs(newPosition - state.tiles.length)].id\n          : state.tiles[newPosition].id\n      } as Player\n    ],\n    purchaseInProgress: undefined,\n    resources: isNextRound\n      ? gatherResources(state).resources\n      : state.resources,\n    round: isNextRound\n      ? state.round + 1\n      : state.round,\n  };\n}\n\nexport const PRODUCED_RESOURCES_PER_ROUND = 3;\nexport function gatherResources(state: State): State {\n  const shrines = state.tileBuildings\n    .filter((b) => b.type === \"shrine\");\n  const resourcesProduced = PRODUCED_RESOURCES_PER_ROUND\n    + (shrines.length === 4\n      ? 1\n      : 0);\n  const resources = state.tileBuildings\n    .filter((b) => b.type !== \"shrine\")\n    .filter((b) => {\n      switch (state.activeTragedy) {\n        case AvailableTragedyEvents.BurningTrees:\n          return b.type !== \"sawmill\";\n        case AvailableTragedyEvents.ContaminatedBlood:\n          return b.type !== \"butchery\";\n        case AvailableTragedyEvents.Rockfall:\n          return b.type !== \"quarry\";\n        case AvailableTragedyEvents.ShatteringEarth:\n          return b.type !== \"mana_rift\";\n        case AvailableTragedyEvents.Vermins:\n          return b.type !== \"farm\";\n        case AvailableTragedyEvents.CollapsedMines:\n          const mineType = state.activeTragedyParams[0] as AvailableTileBuildings;\n          return b.type !== mineType;\n\n        default:\n          return true;\n      }\n    })\n    .reduce((prev, curr) => {\n      prev[state.tiles\n        .find((t) => t.id === curr.tileId)\n        .type] += resourcesProduced;\n      return prev;\n    }, Object.assign({}, state.resources) as Resources);\n\n  return gatherShrineResources({\n    ...state,\n    resources\n  });\n}\n\nexport function gatherShrineResources(state: State) {\n  const shrines = state.tileBuildings\n    .filter((b) => b.type === \"shrine\");\n\n  if (!shrines) {\n    return state;\n  }\n\n  return {\n    ...state,\n    resources: {\n      ...state.resources,\n      blood: shrines.length > 2 ? state.resources.blood + 1 : state.resources.blood,\n      gold: shrines.length > 0 ? state.resources.gold + 1 : state.resources.gold,\n      mana: shrines.length > 1 ? state.resources.mana + 1 : state.resources.mana,\n    }\n  };\n}\n\nexport function openPurchaseForTile(state: State, tile: Tile): State {\n  return {\n    ...state,\n    purchaseInProgress: tile.id\n  };\n}\n\nexport function closePurchasePanel(state: State) {\n  return {\n    ...state,\n    purchaseInProgress: undefined\n  };\n}\n\nexport function buyBuilding(state: State, building: TileBuilding): State {\n  const costs = TileBuildingResourceCost[building.type];\n\n  return {\n    ...state,\n    purchaseInProgress: undefined,\n    resources: {\n      blood: state.resources.blood - costs.blood,\n      coal: state.resources.coal - costs.coal,\n      food: state.resources.food - costs.food,\n      gold: state.resources.gold - costs.gold,\n      iron: state.resources.iron - costs.iron,\n      mana: state.resources.mana - costs.mana,\n      stone: state.resources.stone - costs.stone,\n      wood: state.resources.wood - costs.wood,\n    },\n    tileBuildings: [\n      ...state.tileBuildings, building\n    ]\n  };\n}\n","import { AvailableTileBuildings } from \"buildings/tile-building\";\nimport { AvailableTragedyEvents } from \"../../board/tragedy\";\nimport { Player } from \"../../player/player\";\nimport { randBetween } from \"../helper\";\nimport { ResourceTileType, State } from \"../state\";\n\nexport function sacrificeResources(\n  state: State,\n  resourceType: ResourceTileType,\n  byAmount: number\n): State {\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.Sacrifice,\n    resources: {\n      ...state.resources,\n      [resourceType]: Math.max(0, state.resources[resourceType] - byAmount)\n    }\n  };\n}\n\nexport function ragingFire(\n  state: State,\n  tileId: string\n): State {\n  const idx = state.tileBuildings.findIndex((tb) => tb.tileId === tileId);\n\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.RagingFire,\n    tileBuildings: [\n      ...state.tileBuildings.slice(0, idx),\n      ...state.tileBuildings.slice(idx + 1),\n    ]\n  };\n}\n\nexport function forgottenEquipment(state: State): State {\n  return {\n    ...state,\n    activeTragedy: undefined,\n    activeTragedyParams: undefined,\n    players: [\n      {\n        ...state.players[0],\n        currentTileId: state.tiles.find((t) => t.type === \"start\").id\n      } as Player\n    ]\n  };\n}\n\nexport function defiledAltar(state: State): State {\n  const shrines = state.tileBuildings.filter((tb) => tb.type === \"shrine\");\n  const idx = randBetween(0, shrines.length - 1);\n\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.DefiledAltar,\n    tileBuildings: [\n      ...state.tileBuildings.filter((tb) => tb.tileId !== shrines[idx].tileId),\n    ]\n  };\n}\n\nexport function pausedResourceProduction(\n  state: State,\n  tragedy: AvailableTragedyEvents\n): State {\n  return {\n    ...state,\n    activeTragedy: tragedy\n  };\n}\n\nexport function collapsedMines(state: State, mineType: AvailableTileBuildings): State {\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.CollapsedMines,\n    activeTragedyParams: [mineType]\n  };\n}\n\nexport function stumblingSteps(state: State): State {\n  return {\n    ...state,\n    activeTragedy: AvailableTragedyEvents.StumblingSteps,\n    activeTragedyParams: [3]\n  };\n}\n","export function guid(): string {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return s4() + s4() + \"-\" + s4() + \"-\" + s4() + \"-\" +\n    s4() + \"-\" + s4() + s4() + s4();\n}\n\nexport function randBetween(min: number, max: number): number {\n  return Math.floor(Math.random() * max) + min;\n}\n","export * from \"./state\";\nexport * from \"./actions/commands\";\n","import { Tile, TileType } from \"../board/tile\";\nimport { AvailableTragedyEvents } from \"../board/tragedy\";\nimport { TileBuilding } from \"../buildings/tile-building\";\nimport { Player } from \"../player/player\";\nimport { guid } from \"./helper\";\n\nexport const LOCALSTORAGE_SAVE_KEY = \"enforted-save-game\";\nexport type ResourceTileType = Exclude<TileType, \"start\" | \"tragedy\" | \"sacred_grounds\">;\n\nexport type Resources = {\n  [key in ResourceTileType]: number;\n};\n\nexport const ResourcesIcons: {\n  [key in ResourceTileType]: string\n} = {\n  blood: \"bloody-stash\",\n  coal: \"brick-pile\",\n  food: \"wheat\",\n  gold: \"two-coins\",\n  iron: \"ore\",\n  mana: \"vortex\",\n  stone: \"stone-block\",\n  wood: \"forest\"\n};\n\nexport interface State {\n  tiles: Tile[];\n  players: Player[];\n  tileBuildings: TileBuilding[];\n  lastDiceRoll?: number;\n  resources: Resources;\n  round: number;\n  activeTragedy?: AvailableTragedyEvents;\n  activeTragedyParams?: any[];\n  /**\n   * Setting this to undefined closes the purchase panel\n   */\n  purchaseInProgress?: string;\n}\n\nexport const initialState = {\n  lastDiceRoll: undefined,\n  players: [],\n  resources: {\n    blood: 0,\n    coal: 0,\n    food: 15,\n    gold: 30,\n    iron: 0,\n    mana: 0,\n    stone: 0,\n    wood: 20,\n  },\n  round: 1,\n  tileBuildings: [],\n  tiles: [\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"bottom\",\n      ring: \"outer\",\n      type: \"start\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"bottom\",\n      ring: \"outer\",\n      type: \"wood\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"bottom\",\n      ring: \"outer\",\n      type: \"sacred_grounds\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), () => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"left\",\n      ring: \"outer\",\n      type: \"food\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"top\",\n      ring: \"outer\",\n      type: \"tragedy\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"top\",\n      ring: \"outer\",\n      type: \"stone\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"top\",\n      ring: \"outer\",\n      type: \"sacred_grounds\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(9), () => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"right\",\n      ring: \"outer\",\n      type: \"gold\",\n    })),\n    ...Array.from<Tile, Partial<Tile>>(Array(9), (_, idx) => ({\n      id: guid(),\n      isCorner: idx === 0 || idx === 8,\n      placement: \"bottom\",\n      ring: \"inner\",\n      type: \"iron\",\n    })),\n    ...Array.from<Tile, Partial<Tile>>(Array(7), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"left\",\n      ring: \"inner\",\n      type: idx === 4 ? \"sacred_grounds\" : \"mana\",\n    })),\n    ...Array.from<Tile, Partial<Tile>>(Array(8), (_, idx) => ({\n      id: guid(),\n      isCorner: idx === 0,\n      placement: \"top\",\n      ring: \"inner\",\n      type: \"coal\",\n    })),\n    {\n      id: guid(),\n      isCorner: true,\n      placement: \"top\",\n      ring: \"inner\",\n      type: \"tragedy\"\n    },\n    ...Array.from<Tile, Partial<Tile>>(Array(7), (_, idx) => ({\n      id: guid(),\n      isCorner: false,\n      placement: \"right\",\n      ring: \"inner\",\n      type: idx === 6 ? \"sacred_grounds\" : \"blood\",\n    })),\n  ]\n} as State;\n\nconst player = {} as Player;\nplayer.name = \"zewa\";\nplayer.currentTileId = initialState.tiles[0].id;\ninitialState.players.push(player);\n","<template>\n  <ux-dialog>\n    <ux-dialog-body>\n      <compose class=\"${bemclasses}\" view.bind=\"dialogView\"></compose>\n    </ux-dialog-body>\n  </ux-dialog>\n</template>\n","import { DialogService } from \"aurelia-dialog\";\nimport { Container } from \"aurelia-framework\";\nimport { kebabCase } from \"lodash\";\n\nexport interface DialogModel {\n  [key: string]: any;\n  /**\n   * the view url (relative to src/)\n   */\n  view: string;\n  /**\n   * any BEM classes to attach\n   */\n  bem?: string;\n}\n\nexport function openDialog(viewModel: any, model: DialogModel, keyboard: boolean | \"Escape\" | \"Enter\" = false) {\n  const dialogService = Container.instance.get(DialogService);\n  model.bem = model.bem || kebabCase(viewModel.name);\n\n  return dialogService.open({\n    centerHorizontalOnly: true,\n    keyboard,\n    model,\n    view: \"utils/generic-dialog.html\",\n    viewModel,\n  });\n}\n"]}